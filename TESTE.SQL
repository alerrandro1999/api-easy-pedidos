
 SELECT COALESCE(max(ITEM),0)+1 as NUMERO FROM PREITENS
WHERE COD_FILIAL = 69
AND CODPREVENDA = 78

UPDATE OR INSERT INTO PREITENS (COD_FILIAL, CODPREVENDA, ITEM, COD_PRODUTO, COD_VENDEDOR, QUANTIDADE, PRODUTO, PRECO_CUSTO, VALOR_TOTAL,PRECO_VENDA, PRECO_FINAL, ORIGEM, MODALIDADE_ICMS, CFOP, CST_ICMS,BASE_ICMS, RED_BASE_ICMS, PORC_ICMS, VALOR_ICMS, MODALIDADE_ICMSST,BASE_ICMSST, RED_BASE_ICMSST, PORC_MVA, PORC_ICMSST, VALOR_ICMSST, CST_IPI, VALOR_IPI, PORC_IPI, CST_PIS, VALOR_PIS, PORC_PIS , CST_CONFINS, VALOR_CONFINS, PORC_CONFINS, PRECO_DESCONTO) VALUES(69, 378, NUMERO, 115, 180, 1.000, 'TOMATE 1Âª', 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);


SELECT a.COD_FILIAL, a.CODPREVENDA, a.ITEM, a.COD_PRODUTO, a.COD_VENDEDOR,
    a.QUANTIDADE, a.ESTOQUE, a.PRECO_CUSTO, a.PRECO_VENDA, a.PROMOCAO,
    a.PRECO_FINAL, a.PORCENTAGEM_COMISSAO, a.COMISSAO, a.COMISSAO_PAGA, a.CFOP,
    a.VALOR_TOTAL, a.CST_ICMS, a.BASE_ICMS, a.VALOR_ICMS, a.PORC_ICMS,
    a.CST_IPI, a.PORC_IPI, a.VALOR_IPI, a.CST_PIS, a.PORC_PIS, a.VALOR_PIS,
    a.PORC_PISST, a.VALOR_PISST, a.CST_COFINS, a.PORC_COFINS, a.VALOR_COFINS,
    a.PORC_MVA, a.ORIGEM, a.MODALIDADE_ICMS, a.RED_BASE_ICMS,
    a.MODALIDADE_ICMSST, a.RED_BASE_ICMSST, a.BASE_ICMSST, a.PORC_ICMSST,
    a.VALOR_ICMSST, a.CODIGO_BARRAS, a.TIPOCOMISSAO, a.PERMITIR_DESCONTO,
    a.PROMOCOES, a.PRECO_DESCONTO, a.DESCONTONEGOCIADO, a.PRECO_DESCONTOMAXIMO,
    a.VALOR_DESCONTO, a.PRECO_PROMOCOES, a.PRODUTO, a.TIPOITEM,
    a.PRODUTOASSOCIADO, a.CODTRIBUTO, a.TRIBUTO, a.XUNIDADE, a.QTDCX,
    a.CUSTO_UNITARIO, a.XCODUNIDADE, a.CPROD, a.XPED, a.ITEMPED, a.CEST, a.NCM
FROM PREITENS a 
WHERE
    a.COD_FILIAL = '69'
    